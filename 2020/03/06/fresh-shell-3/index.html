<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fresh Shell 3：基于 Node.js 的 JavaScript「壳中壳」 - /rkm/</title>
    <meta name="description" content="Can you hear me?">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-148373443-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-148373443-1');
    </script>
  <script src="/imouse.js"></script>
  <script>window.addEventListener('DOMContentLoaded', () => IMouse.default.init({
      defaultBackgroundColor: 'rgba(1, 80, 111, .15)',
      activeBackgroundColor: 'rgba(1, 80, 111, .25)',
      transitionDuration: 100,
    }))</script>
    
    <link rel="preload" href="/assets/css/0.styles.18bab253.css" as="style"><link rel="preload" href="/assets/js/app.17639f37.js" as="script"><link rel="preload" href="/assets/js/3.6722ad08.js" as="script"><link rel="preload" href="/assets/js/22.6f613146.js" as="script"><link rel="prefetch" href="/assets/js/10.38a68410.js"><link rel="prefetch" href="/assets/js/11.8fb0e355.js"><link rel="prefetch" href="/assets/js/12.5c4e0b74.js"><link rel="prefetch" href="/assets/js/13.153cab41.js"><link rel="prefetch" href="/assets/js/14.098dea55.js"><link rel="prefetch" href="/assets/js/15.f5b80650.js"><link rel="prefetch" href="/assets/js/16.7689aa28.js"><link rel="prefetch" href="/assets/js/17.3a0f0a72.js"><link rel="prefetch" href="/assets/js/18.e8e1ac50.js"><link rel="prefetch" href="/assets/js/19.1322396b.js"><link rel="prefetch" href="/assets/js/20.08dae459.js"><link rel="prefetch" href="/assets/js/21.42ca33c4.js"><link rel="prefetch" href="/assets/js/23.5639d6c3.js"><link rel="prefetch" href="/assets/js/24.fe044838.js"><link rel="prefetch" href="/assets/js/25.4de35996.js"><link rel="prefetch" href="/assets/js/4.ba1254c8.js"><link rel="prefetch" href="/assets/js/5.26135cfb.js"><link rel="prefetch" href="/assets/js/6.3b871e45.js"><link rel="prefetch" href="/assets/js/7.3e885d9e.js"><link rel="prefetch" href="/assets/js/8.34440226.js"><link rel="prefetch" href="/assets/js/9.b332d2b2.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.d8fc2e54.js">
    <link rel="stylesheet" href="/assets/css/0.styles.18bab253.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout"><section class="side-container"><header><a href="/" class="a-block nav-head"><div class="nav-title">/rkm/</div> <div class="nav-subtitle">Can you hear me?</div></a> <ul class="nav-link-list"><a href="/about/" class="a-block nav-link-item">关于</a><a href="https://github.com/rikumi" target="_blank" rel="noopener noreferrer" class="nav-link external a-block nav-link-item">GitHub</a><a href="/friends/" class="a-block nav-link-item">朋友们</a><a href="/works/" class="a-block nav-link-item">作品</a></ul></header> <footer class="nav-footer">
    Proudly published with VuePress
    <br>Theme
    <a href="https://github.com/rikumi/vuepress-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> by
    <a href="https://github.com/rikumi/" target="_blank" rel="noreferrer noopener">Rikumi</a> <br>Designed by
    <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a> <br>
    © 2020
    <a href="/">/rkm/</a></footer></section> <div class="mobile-header"><div class="single-column-drawer-container"><div class="drawer-content"><div class="drawer-menu"><a href="/about/" class="a-block drawer-menu-item">
          关于
        </a><a href="https://github.com/rikumi" target="_blank" rel="noopener noreferrer" class="nav-link external a-block drawer-menu-item">
          GitHub
        </a><a href="/friends/" class="a-block drawer-menu-item">
          朋友们
        </a><a href="/works/" class="a-block drawer-menu-item">
          作品
        </a></div></div></div> <div class="navbar navbar-light single-column-nav-container"><div class="nav-background"></div> <div class="container container-narrow nav-content"><button id="nav_dropdown_btn" type="button" class="nav-dropdown-toggle"><i class="material-icons">menu</i></button> <a href="/" class="navbar-brand">/rkm/
      </a></div></div> <!----></div> <div class="stream-container"><div class="post-list-container post-list-container-shadow"><div class="post"><div class="post-head-wrapper" style="background-image:url(https://user-images.githubusercontent.com/5051300/76057979-0e7d4a00-5fb6-11ea-9db8-188b083578e4.png);"><div class="post-title">
            Fresh Shell 3：基于 Node.js 的 JavaScript「壳中壳」
            <div class="post-meta"><time>2020-03-06</time> <!----> </div></div></div> <div class="post-body-wrapper"><div class="post-body"><div class="content__default"><p>项目主页：<a href="https://github.com/rikumi/fresh-shell" target="_blank" rel="noopener noreferrer">https://github.com/rikumi/fresh-shell<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://img.shields.io/npm/v/fresh-shell" alt=""> <img src="https://img.shields.io/github/last-commit/rikumi/fresh-shell" alt=""></p> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>Shell 是 Unix 世界中一个不可或缺的工具，但它的语法也许不那么优雅、难以学习，阻止了你很多突发奇想，让很多需要高生产力的临时需求不得不变成写一个冗长的 Node 脚本再去调试运行。</p> <p>例如，你如何批量重命名一大堆文件？如何把一个文件夹里所有的 png 文件都调用一次 <code>tinypng</code> CLI，并用得到的压缩图片文件替换原文件？对于没有系统学习过 Shell 语法的开发者，这些任务都是艰巨的，写一个这样的脚本往往要用到 Node.js，同时一些细小的任务还是需要用到 Shell。</p> <p>人们曾经想过改进 Shell 的语法，但事实证明，这是一个大工程，而且是一个社会工程。我们常用的 Zsh 对 Bash 兼容性很好，但它语法也就跟 Bash 一样复杂；假如我们下决心用上稍微优雅一些的 Fish，如何把别人留在开发文档里的 Bash 复杂命令改成 Fish？如何去说服你的同事跟你一起用 Fish 来避免分享高级用法的过程中出现语法冲突？</p> <p>有开发者想到了将两种语法融合，<a href="https://xon.sh/" target="_blank" rel="noopener noreferrer">Xonsh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 就是这样一个产物。但经过长期使用，我们会发现 Xonsh 并没有实现全部的 Shell 语法，很多语法都是缺失的，这些问题的根源在于 Xonsh 试图把两个语法糅合在一起，而不是区分它们的上下文。</p> <p>Fresh 是一个构造极简的 JavaScript Unix Shell。它能在<strong>不破坏语法</strong>的前提下，让 JavaScript 语法和<strong>任意一种标准 Shell</strong> 的语法融合，并同时满足你基于 Shell 语法的日常使用和基于 JavaScript 的 Hacking。</p> <p>为什么不破坏语法？因为 Fresh 区分上下文，使用自动补全的 Tag Function 来处理 Shell 语法。</p> <h2 id="安装和使用"><a href="#安装和使用" class="header-anchor">#</a> 安装和使用</h2> <p>安装 Fresh 之前，请确保你的 Node.JS 已安装并位于 <code>/usr/local/bin/node</code> 下。</p> <div class="language-sh extra-class"><pre class="language-sh"><code>rikumi $ <span class="token function">npm</span> i -g fresh-shell
rikumi $ fresh

rikumi ƒ`<span class="token operator">|</span>
</code></pre></div><p>安装后，你可以将 fresh 的入口程序（通常为 <code>/usr/local/bin/fresh</code>）设置为终端和 VS Code 的默认 Shell。</p> <p>Fresh 中必备的两个字符是 ƒ`，我们可以称之为「软提示符」（位于标准输入流而非输出流中、可以删除和修改的提示符）。软提示符的存在让我们可以直接键入 Shell 命令，而不需要多余的语法。</p> <p>输入任何你需要的 Shell 命令（如 <code>ls</code>），回车之后，Fresh 会自动补全末尾的反引号 `，因此会产生 Tag Function Call 语法：ƒ`<code>ls</code>`，其中函数 ƒ 的含义为<strong>同步执行 Shell</strong>，因此 <code>ls</code> 命令会被执行。这就是 Fresh 的基本工作原理。</p> <h2 id="如何输入-f"><a href="#如何输入-f" class="header-anchor">#</a> 如何输入 ƒ`</h2> <p>使用 option+F 可以输入 ƒ；`（反引号）是半角状态下 Tab 上方的按键。</p> <h2 id="交互执行和隐藏执行"><a href="#交互执行和隐藏执行" class="header-anchor">#</a> 交互执行和隐藏执行</h2> <p>ƒ 函数（<code>exec</code> 函数）有两种模式：交互执行和隐藏执行。</p> <p>当输入的命令行是单一的 ƒ 调用时，会进入交互执行状态，输入输出以标准输入输出的形式提供；当 ƒ 调用是输入的表达式中的一部分，会进入隐藏执行状态，标准输出和标准错误输出不会直接上屏，而是作为 ƒ 函数的返回值提供。</p> <p>ƒ 函数的返回值是一个特殊字符串，字符串的值为子程序的标准输出（经过 UTF-8 解码得到的内容）；该字符串上附加有 <code>status</code>、<code>stderr</code>、<code>error</code> 三个属性，分别表示状态码、标准错误输出（经过 UTF-8 解码得到的内容）和 JavaScript 错误对象。</p> <p>下图中分别展示了命令 <code>git status</code> 的交互执行模式，以及隐藏执行模式下的 <code>status</code>、<code>stderr</code>、<code>error</code> 属性。</p> <p><img src="https://user-images.githubusercontent.com/5051300/76059992-302d0000-5fbb-11ea-8c11-99db4e89bcaa.png" alt="image"></p> <h2 id="内置指令"><a href="#内置指令" class="header-anchor">#</a> 内置指令</h2> <p>Fresh 本身并不是 Unix Shell，而是 Unix Shell 的一层封装，所有的 Shell 命令都是在子进程中执行的。这也就意味着 Fresh 执行的 Shell 无法改变 Fresh 本身的状态。而一部分状态是需要跨命令保持的，其中就包括<strong>工作目录（CWD）</strong>、<strong>环境变量</strong>以及<strong>别名</strong></p> <p>如果我们用 Shell 模式执行 <code>cd</code>/<code>export</code>/<code>alias</code> 语句，它们退出后不会对 Fresh 本身产生任何影响；因此，Fresh 实现了 <code>cd</code>/<code>export</code>/<code>alias</code> <strong>内置指令</strong>，让单一的 <code>cd</code>/<code>export</code>/<code>alias</code> 语句能够工作。</p> <p>注意，Fresh 只支持在单一语句中独立使用 <code>cd &lt;directory&gt;</code>、<code>export &lt;KEY&gt;=&lt;value&gt;</code>、<code>alias [&lt;command&gt;=&lt;replacement&gt;]</code> 的语法，并支持在其中进行简单的环境变量插值；复杂的用法将会以 Unix Shell 模式执行，导致它们不会对 Fresh 本身的状态产生影响。以下是一个对比简单 <code>cd</code>/<code>export</code> 语句和复杂 <code>cd</code>/<code>export</code> 语句的例子。</p> <p><img src="https://user-images.githubusercontent.com/5051300/76062025-c3683480-5fbf-11ea-83c5-aa1d4e9e49e0.png" alt="image"></p> <p>可以看到，简单的 <code>cd</code>/<code>export</code>/<code>alias</code> 语句会被 Fresh 捕获，产生的效果会对后面的指令生效；复杂的 <code>cd</code>/<code>export</code>/<code>alias</code> 语句会采用 Shell 模式进行执行，因此不会对 Fresh 本身以及后面的指令产生影响。</p> <h2 id="node-js-环境与自动-require"><a href="#node-js-环境与自动-require" class="header-anchor">#</a> Node.js 环境与自动 require</h2> <p>Fresh 的本质是一个 Node.js REPL（但并没有使用 Node.js REPL 库，而是用表现更稳定、可定制性更强的 Node.js Readline 库进行实现），其中只有 ƒ 函数是与 Shell 执行相关的；除 ƒ 函数之外，Fresh 也是一个完整的 Node.js 执行环境。</p> <p>相比标准 Node REPL，Fresh 面向终端场景，加入了自动 <code>require</code> 的能力，即在全局命名空间下，找不到的对象，会自动尝试 <code>require</code>。同时，在配置文件中也可以增加新的自动导入函数。</p> <p><img src="https://user-images.githubusercontent.com/5051300/76062665-17274d80-5fc1-11ea-9925-bc6d2f8459c3.png" alt="image"></p> <h2 id="融合使用"><a href="#融合使用" class="header-anchor">#</a> 融合使用</h2> <p>借助上述特性，可以将 Shell 命令与 JavaScript 融合使用，Shell 中使用模板插值语法 <code>${}</code> 可以嵌入 JavaScript 表达式；JavaScript 中也可以使用 ƒ 函数嵌入 Shell 执行结果：</p> <p><img src="https://user-images.githubusercontent.com/5051300/76063500-cd3f6700-5fc2-11ea-9ab9-f35371766d24.png" alt="image"></p> <h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <p>Fresh 支持使用配置文件进行自定义，实现嵌套 Shell 和配置继承、提示符美化（如实现简易的 Powerline 风格）、定制 JavaScript 环境、定制 Tab 自动完成、定制颜色高亮等。</p> <p>配置文件位于 <code>~/.freshrc.js</code>，会在 Fresh 启动时被执行。配置文件中可以对全局配置对象 <code>config</code> 进行修改。预设的 config 对象参见<a href="https://github.com/rikumi/fresh-shell/blob/master/src/core/config.js" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="定制动词"><a href="#定制动词" class="header-anchor">#</a> 定制动词</h3> <p>修改 <code>config.verb</code>，可以将默认的动词 ƒ 修改成其他<strong>合法的 JavaScript 标识符</strong>。</p> <h3 id="嵌套-shell-与执行前指令"><a href="#嵌套-shell-与执行前指令" class="header-anchor">#</a> 嵌套 Shell 与执行前指令</h3> <p>Fresh 可以使用 Bash、Zsh、Fish、Xonsh 等任何支持 <code>-c</code> 参数的第三方 Shell 作为内嵌 Shell 工具，只需在配置文件中更改 <code>config.shell</code> 即可：</p> <div class="language-js extra-class"><pre class="language-js"><code>config<span class="token punctuation">.</span>shell <span class="token operator">=</span> <span class="token string">'/bin/zsh'</span><span class="token punctuation">;</span>
</code></pre></div><p>被嵌套的 Shell 默认以 <code>--login</code>（Login + Interactive）方式执行，在该模式下，Shell 将会加载更多的默认环境变量，但不会自动加载配置文件。</p> <p>如要修改被嵌套的 Shell 的附加执行参数（默认为 <code>['--login']</code>），可以在配置文件中操作 <code>config.shellArgs</code>。注意，<code>-c</code> 将会自动添加；</p> <p>如需加载 <code>.bashrc</code>/<code>.zshrc</code> 等配置文件（不推荐），可以在 <code>config.shellCommandPrefix</code> 中设置需要添加到每次 Shell 被执行字符串之前的指令，例如 <code>config.shellCommandPrefix = 'source ~/.bashrc;'</code>，注意不要忘了以分号结尾。</p> <h3 id="配置文件中执行-shell-语句"><a href="#配置文件中执行-shell-语句" class="header-anchor">#</a> 配置文件中执行 Shell 语句</h3> <p>在配置文件中，可以像在 Fresh 内一样使用 ƒ 函数，但固定处于隐藏执行模式，如果要查看输出，需要配合 <code>console.log</code> 等方式。</p> <p>请注意对 <code>config.shell</code> 的修改与执行 Shell 语句之间的先后顺序。</p> <h3 id="定制提示符（以-powerline-风格为例）"><a href="#定制提示符（以-powerline-风格为例）" class="header-anchor">#</a> 定制提示符（以 Powerline 风格为例）</h3> <p>为了方便自定义，配置对象中 <code>config.prompt</code> 函数被拆成三个函数：<code>config.prompt</code>、<code>config.git</code>、<code>config.cwd</code>（实际被 Fresh 调用的只有 <code>config.prompt</code> 函数），以便于分别改写提示符样式、Git 显示格式和 CWD 显示格式。</p> <p>这里以 Powerline 风格提示符为例，展示如何改写提示符样式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>

config<span class="token punctuation">.</span><span class="token function-variable function">prompt</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">status <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> bgColor <span class="token operator">=</span> status <span class="token operator">?</span> chalk<span class="token punctuation">.</span>bgRed <span class="token operator">:</span> chalk<span class="token punctuation">.</span>bgBlue<span class="token punctuation">;</span>
    <span class="token keyword">const</span> fgColor <span class="token operator">=</span> status <span class="token operator">?</span> chalk<span class="token punctuation">.</span>red <span class="token operator">:</span> chalk<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>
    <span class="token keyword">const</span> bgBlack <span class="token operator">=</span> chalk<span class="token punctuation">.</span>bgBlack<span class="token punctuation">;</span>
    <span class="token keyword">const</span> fgBlack <span class="token operator">=</span> chalk<span class="token punctuation">.</span>black<span class="token punctuation">;</span>
    <span class="token keyword">const</span> fgWhite <span class="token operator">=</span> chalk<span class="token punctuation">.</span>white<span class="token punctuation">;</span>
    <span class="token keyword">const</span> git <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">git</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>git<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">bgColor</span><span class="token punctuation">(</span><span class="token string">' '</span> <span class="token operator">+</span> <span class="token function">fgBlack</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token function">bgBlack</span><span class="token punctuation">(</span><span class="token function">fgColor</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fgWhite</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">git</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token function">fgBlack</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">bgColor</span><span class="token punctuation">(</span><span class="token string">' '</span> <span class="token operator">+</span> <span class="token function">fgBlack</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span>
            <span class="token function">fgColor</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>效果如下：</p> <p><img src="https://user-images.githubusercontent.com/5051300/76068492-35df1180-5fcc-11ea-9720-e9209b4f86f0.png" alt="image"></p> <h3 id="定制-tab-自动完成"><a href="#定制-tab-自动完成" class="header-anchor">#</a> 定制 Tab 自动完成</h3> <p>Fresh 默认配置中提供了路径自动完成和 Git 分支自动完成；你还可以修改 <code>config.complete</code> 函数来完善这一特性。自动完成函数的写法参见 <a href="https://nodejs.org/api/readline.html#readline_use_of_the_completer_function" target="_blank" rel="noopener noreferrer">Readline 文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="定制语法高亮"><a href="#定制语法高亮" class="header-anchor">#</a> 定制语法高亮</h3> <p>为了方便自定义，默认配置对象中将语法高亮分为四个函数：<code>config.colorizeToken</code>、<code>config.colorizeCode</code>、<code>config.colorizeCommand</code>、<code>config.colorizeOutput</code>，它们分别对应于对单个 JavaScript Token 的高亮、对一段代码的 Token 解析与高亮、对输入命令的高亮以及对 JavaScript 输出结果的高亮。实际被 Fresh 调用的只有 <code>config.colorizeCommand</code> 和 <code>config.colorizeOutput</code> 两个函数。</p> <h3 id="定制进程标题"><a href="#定制进程标题" class="header-anchor">#</a> 定制进程标题</h3> <p>改变 <code>config.makeTitle</code> 函数可以定制 Fresh 的进程标题，用于显示在 GUI 终端中。该函数接受零个或一个参数，接受零个参数时，需要返回 Fresh 处于空闲状态时的进程标题；接受一个参数时，该参数是要执行的命令行程序的 argv 列表，需要返回 Fresh 执行该子程序时的默认进程标题。</p> <h2 id="建议与贡献"><a href="#建议与贡献" class="header-anchor">#</a> 建议与贡献</h2> <p>欢迎对本项目提出 Issue 或 Pull Requests。需要注意的是，Fresh 作为一个外壳程序，对于功能上的要求会进行一定的取舍，在保持实现简单的前提下合理迭代。</p> <p>因为 Fresh 的最大意义是用 &lt; 500 行代码实现 JavaScript 与其他 Shell 的融合，而非做一个完美无缺的 Shell 本身。</p></div></div></div> <div class="post-comment-wrapper"><!----></div></div></div></div> <div class="extra-container"><!----></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.17639f37.js" defer></script><script src="/assets/js/3.6722ad08.js" defer></script><script src="/assets/js/22.6f613146.js" defer></script>
  </body>
</html>
